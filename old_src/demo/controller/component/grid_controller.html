<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	"http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
	<head>
		<title>Component Tree Controller Example</title>
		<link rel="stylesheet" type="text/css" href="../../../../../../css/table.css">>
	</head>
	<body>
<!-- -----------------------------------------------------------------------
												DEMO HTML BLOCK
 -------------------------------------------------------------------------->
<div id="demo-html">
<div id="js_demo_app_controller">
	<h3>Grid representation</h3>
	<table id="js_demo_grid_controller">
	</table>
</div>
</div>
<!-- -----------------------------------------------------------------------
												DEMO JAVASCRIPT BLOCK
 -------------------------------------------------------------------------->
<div style='clear:both'></div>
<script type='text/javascript'
	src='../../../../../steal/steal.js'>
</script>
<script type='text/javascript' id="demo-source">
steal(
	'mad/demo/init.js'
).then(
	'mad/test/data/model/person.js'
).then(function() {
	var map = new mad.object.Map({
		'id': 'id',
		'name': 'name',
		'surname': 'surname',
		'freelancer': 'freelancer',
		'phone': 'phone',
		'email': 'email',
		'children': {
			'key': 'children',
			'func': mad.object.Map.mapObjects
		}
	});

	var columnNames = ['Name', 'Surname', 'Freelancer', 'Phone', 'Email', 'Children'];

	var columnModel = [{
		'name': 'name',
		'index': 'name'
	}, {
		'name': 'surname',
		'index': 'surname'
	}, {
		'name': 'freelancer',
		'index': 'freelancer'
	}, {
		'name': 'phone',
		'index': 'phone'
	}, {
		'name': 'email',
		'index': 'email'
	}, {
		'name': 'children',
		'index': 'children',
		'valueAdapter': function (value, mappedItem, item, columnModel) {
			var returnValue = mappedItem.children.length;
			return returnValue;
		}
	}];

	// Instanciate a list controller
	var grid = new mad.controller.component.GridController($('#js_demo_grid_controller'), {
		'map': map,
		'itemClass': demo.model.Person,
		'columnNames': columnNames,
		'columnModel': columnModel,
		'callbacks': {
			'itemSelected': function (element, event, item) {
				console.log ('selected : ', item);
			},
			'itemRightSelected': function (element, event, item) {
				console.log ('right selected : ', item);
			},
			'itemHovered': function (element, event, item) {
				console.log ('hovered : ', item);
			}
		}
	}, {});
	
	grid.render();
	demo.model.Person.findAll({}, function (persons, response, request) {
		grid.load(persons);
	}, function (response) {});

});
</script>
	</body>
</html>